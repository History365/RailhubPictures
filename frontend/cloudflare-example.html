<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RailHub Pictures - Cloudflare Example</title>
    <link rel="stylesheet" href="assets/stylesheet/styles.css">
    <style>
        .api-example {
            max-width: 800px;
            margin: 30px auto;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .api-example h2 {
            margin-top: 0;
            color: #333;
        }
        
        .api-example pre {
            background-color: #282c34;
            color: #abb2bf;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
        }
        
        .api-example button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        
        .api-example button:hover {
            background-color: #0069d9;
        }
        
        #results {
            margin-top: 20px;
            padding: 15px;
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 4px;
            min-height: 100px;
        }
    </style>
</head>
<body>
    <div id="header-placeholder"></div>
    
    <div class="main-content">
        <div class="api-example">
            <h2>Cloudflare API Integration Example</h2>
            
            <p>This page demonstrates how to use the new Cloudflare Workers API for RailHub Pictures.</p>
            
            <div class="example-buttons">
                <button onclick="getLatestPhotos()">Get Latest Photos</button>
                <button onclick="getPhotoById()">Get Photo by ID</button>
                <button onclick="getAllUnits()">Get All Units</button>
            </div>
            
            <h3>API Response:</h3>
            <div id="results">
                <em>API results will appear here...</em>
            </div>
            
            <h3>How to Use the API Client</h3>
            <pre>// Get latest photos
railhubAPI.getLatestPhotos(10)
  .then(photos => {
    console.log('Latest photos:', photos);
  })
  .catch(error => {
    console.error('Error:', error);
  });

// Get a specific photo
railhubAPI.getPhoto(123)
  .then(photo => {
    console.log('Photo details:', photo);
  })
  .catch(error => {
    console.error('Error:', error);
  });

// Upload a photo
const formData = new FormData();
formData.append('photo', fileInput.files[0]);
formData.append('title', 'My awesome train photo');
formData.append('description', 'Took this at the station');
formData.append('location', 'Chicago, IL');
formData.append('photo_date', '2023-08-15');
formData.append('units', JSON.stringify([42, 57])); // Unit IDs
formData.append('primary_unit', 42); // Primary unit ID

railhubAPI.uploadPhoto(formData)
  .then(result => {
    console.log('Upload successful:', result);
  })
  .catch(error => {
    console.error('Upload error:', error);
  });
</pre>
        </div>
    </div>
    
    <div id="footer-placeholder"></div>
    
    <!-- Include the API Client and Clerk Integration -->
    <script src="assets/scripts/cloudflare/api-client.js"></script>
    <script src="assets/scripts/cloudflare/clerk-integration.js"></script>
    <script src="assets/scripts/header-nav.js"></script>
    <script src="assets/scripts/footer.js"></script>
    
    <script>
        // Example API functions
        async function getLatestPhotos() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<em>Loading latest photos...</em>';
            
            try {
                const photos = await railhubAPI.getLatestPhotos(5);
                displayResults(photos);
            } catch (error) {
                resultsDiv.innerHTML = `<strong>Error:</strong> ${error.message}`;
            }
        }
        
        async function getPhotoById() {
            const photoId = prompt('Enter a photo ID:', '1');
            if (!photoId) return;
            
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = `<em>Loading photo ${photoId}...</em>`;
            
            try {
                const photo = await railhubAPI.getPhoto(photoId);
                displayResults(photo);
            } catch (error) {
                resultsDiv.innerHTML = `<strong>Error:</strong> ${error.message}`;
            }
        }
        
        async function getAllUnits() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<em>Loading all units...</em>';
            
            try {
                const units = await railhubAPI.getAllUnits();
                displayResults(units);
            } catch (error) {
                resultsDiv.innerHTML = `<strong>Error:</strong> ${error.message}`;
            }
        }
        
        function displayResults(data) {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
        }
    </script>
</body>
</html>
