<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Watermark Demo - RailHub Pictures</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f7fa;
        }
        h1, h2 {
            color: #2c3e50;
        }
        .container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 20px;
            margin-bottom: 30px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }
        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #2980b9;
        }
        .preview-container {
            margin-top: 30px;
        }
        .image-preview {
            max-width: 100%;
            height: auto;
            border: 1px solid #ddd;
            margin-top: 10px;
        }
        .options-container {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }
        .option-group {
            flex: 1;
            min-width: 300px;
        }
        .color-preview {
            width: 30px;
            height: 30px;
            display: inline-block;
            border: 1px solid #ddd;
            vertical-align: middle;
            margin-left: 10px;
        }
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
        }
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            margin-right: 5px;
        }
        .tab.active {
            border-bottom: 2px solid #3498db;
            font-weight: 500;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <header>
        <h1>RailHub Pictures - Image Attribution Demo</h1>
        <p>Test how images with attribution will look before implementing the feature</p>
    </header>

    <div class="container">
        <div class="tabs">
            <div class="tab active" data-tab="watermark">Text Attribution</div>
            <div class="tab" data-tab="blackbar">Black Bar with Credit</div>
        </div>

        <div class="tab-content active" id="watermark-tab">
            <h2>Text Attribution Demo</h2>
            <p>Upload an image to see how it would look with a semi-transparent text attribution</p>
        </div>

        <div class="tab-content" id="blackbar-tab">
            <h2>Black Bar with Attribution Demo</h2>
            <p>Upload an image to see how it would look with a black bar at the bottom containing attribution text</p>
        </div>

        <div class="form-group">
            <label for="image-upload">Select an image:</label>
            <input type="file" id="image-upload" class="form-control" accept="image/*">
        </div>

        <div class="form-group">
            <label for="contributor-name">Contributor Name:</label>
            <input type="text" id="contributor-name" class="form-control" 
                   placeholder="Enter contributor name" value="John Smith">
        </div>

        <div class="options-container">
            <div class="option-group" id="watermark-options">
                <h3>Text Attribution Options</h3>
                <div class="form-group">
                    <label for="watermark-opacity">Opacity: <span id="opacity-value">30%</span></label>
                    <input type="range" id="watermark-opacity" min="10" max="90" value="30">
                </div>
                <div class="form-group">
                    <label for="watermark-size">Size: <span id="size-value">24px</span></label>
                    <input type="range" id="watermark-size" min="12" max="48" value="24">
                </div>
                <div class="form-group">
                    <label for="watermark-color">Color:</label>
                    <input type="color" id="watermark-color" value="#ffffff">
                    <span class="color-preview" id="color-preview" style="background-color: #ffffff"></span>
                </div>
                <div class="form-group">
                    <label for="watermark-position">Position:</label>
                    <select id="watermark-position" class="form-control">
                        <option value="center">Center</option>
                        <option value="bottom-right" selected>Bottom Right</option>
                        <option value="bottom-left">Bottom Left</option>
                        <option value="top-right">Top Right</option>
                        <option value="top-left">Top Left</option>
                    </select>
                </div>
            </div>
            
            <div class="option-group" id="blackbar-options" style="display: none;">
                <h3>Black Bar Options</h3>
                <div class="form-group">
                    <label for="bar-height">Height: <span id="bar-height-value">40px</span></label>
                    <input type="range" id="bar-height" min="20" max="80" value="40">
                </div>
                <div class="form-group">
                    <label for="bar-opacity">Opacity: <span id="bar-opacity-value">80%</span></label>
                    <input type="range" id="bar-opacity" min="50" max="100" value="80">
                </div>
                <div class="form-group">
                    <label for="text-color">Text Color:</label>
                    <input type="color" id="text-color" value="#ffffff">
                    <span class="color-preview" id="text-color-preview" style="background-color: #ffffff"></span>
                </div>
                <div class="form-group">
                    <label for="text-size">Text Size: <span id="text-size-value">16px</span></label>
                    <input type="range" id="text-size" min="12" max="24" value="16">
                </div>
            </div>
        </div>

        <button id="apply-watermark" type="button">Apply Attribution</button>
        
        <div class="preview-container">
            <h3>Preview</h3>
            <div id="original-container">
                <h4>Original Image</h4>
                <img id="original-preview" class="image-preview">
            </div>
            <div id="watermarked-container">
                <h4>Image with Attribution</h4>
                <img id="watermarked-preview" class="image-preview">
            </div>
        </div>

        <div style="margin-top: 30px;">
            <button id="download-image" type="button" disabled>Download Attributed Image</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOM Elements
            const imageUpload = document.getElementById('image-upload');
            const contributorName = document.getElementById('contributor-name');
            const applyWatermarkBtn = document.getElementById('apply-watermark');
            const downloadBtn = document.getElementById('download-image');
            const originalPreview = document.getElementById('original-preview');
            const watermarkedPreview = document.getElementById('watermarked-preview');
            
            // Watermark options
            const watermarkOpacity = document.getElementById('watermark-opacity');
            const watermarkSize = document.getElementById('watermark-size');
            const watermarkColor = document.getElementById('watermark-color');
            const watermarkPosition = document.getElementById('watermark-position');
            
            // Black bar options
            const barHeight = document.getElementById('bar-height');
            const barOpacity = document.getElementById('bar-opacity');
            const textColor = document.getElementById('text-color');
            const textSize = document.getElementById('text-size');
            
            // Tab handling
            const tabs = document.querySelectorAll('.tab');
            let activeTab = 'watermark'; // Default active tab
            
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    // Remove active class from all tabs
                    tabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Hide all tab contents
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    
                    // Show selected tab content
                    activeTab = this.getAttribute('data-tab');
                    document.getElementById(activeTab + '-tab').classList.add('active');
                    
                    // Toggle option groups
                    if (activeTab === 'watermark') {
                        document.getElementById('watermark-options').style.display = 'block';
                        document.getElementById('blackbar-options').style.display = 'none';
                    } else {
                        document.getElementById('watermark-options').style.display = 'none';
                        document.getElementById('blackbar-options').style.display = 'block';
                    }
                    
                    // If we have an image loaded, reapply the watermark
                    if (originalPreview.src) {
                        applyWatermark();
                    }
                });
            });
            
            // Range input display values
            watermarkOpacity.addEventListener('input', function() {
                document.getElementById('opacity-value').textContent = this.value + '%';
            });
            
            watermarkSize.addEventListener('input', function() {
                document.getElementById('size-value').textContent = this.value + 'px';
            });
            
            barHeight.addEventListener('input', function() {
                document.getElementById('bar-height-value').textContent = this.value + 'px';
            });
            
            barOpacity.addEventListener('input', function() {
                document.getElementById('bar-opacity-value').textContent = this.value + '%';
            });
            
            textSize.addEventListener('input', function() {
                document.getElementById('text-size-value').textContent = this.value + 'px';
            });
            
            // Color preview updates
            watermarkColor.addEventListener('input', function() {
                document.getElementById('color-preview').style.backgroundColor = this.value;
            });
            
            textColor.addEventListener('input', function() {
                document.getElementById('text-color-preview').style.backgroundColor = this.value;
            });
            
            // Handle file selection
            imageUpload.addEventListener('change', function(e) {
                if (e.target.files && e.target.files[0]) {
                    const reader = new FileReader();
                    
                    reader.onload = function(event) {
                        originalPreview.src = event.target.result;
                        applyWatermark();
                    }
                    
                    reader.readAsDataURL(e.target.files[0]);
                }
            });
            
            // Apply watermark button
            applyWatermarkBtn.addEventListener('click', applyWatermark);
            
            // Download watermarked image
            downloadBtn.addEventListener('click', function() {
                if (!watermarkedPreview.src) return;
                
                const link = document.createElement('a');
                link.download = 'railhub-watermarked-image.jpg';
                link.href = watermarkedPreview.src;
                link.click();
            });
            
            // Function to apply watermark
            function applyWatermark() {
                if (!originalPreview.src) {
                    alert('Please select an image first');
                    return;
                }
                
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                const img = new Image();
                
                img.onload = function() {
                    canvas.width = img.width;
                    canvas.height = img.height;
                    
                    // Draw original image
                    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                    
                    const name = contributorName.value || 'Unknown Contributor';
                    const watermarkText = `Photo Â© RailHubPictures.org | ${name}`;
                    
                    if (activeTab === 'watermark') {
                        // Apply text watermark
                        ctx.globalAlpha = watermarkOpacity.value / 100;
                        ctx.fillStyle = watermarkColor.value;
                        ctx.font = `${watermarkSize.value}px Arial`;
                        
                        // Position the watermark
                        const position = watermarkPosition.value;
                        const textWidth = ctx.measureText(watermarkText).width;
                        const padding = 20;
                        let x, y;
                        
                        switch (position) {
                            case 'center':
                                x = (canvas.width - textWidth) / 2;
                                y = canvas.height / 2;
                                break;
                            case 'bottom-right':
                                x = canvas.width - textWidth - padding;
                                y = canvas.height - padding;
                                break;
                            case 'bottom-left':
                                x = padding;
                                y = canvas.height - padding;
                                break;
                            case 'top-right':
                                x = canvas.width - textWidth - padding;
                                y = padding + parseInt(watermarkSize.value);
                                break;
                            case 'top-left':
                                x = padding;
                                y = padding + parseInt(watermarkSize.value);
                                break;
                        }
                        
                        ctx.fillText(watermarkText, x, y);
                    } else {
                        // Apply black bar with text
                        const barHeightValue = parseInt(barHeight.value);
                        ctx.fillStyle = `rgba(0, 0, 0, ${barOpacity.value / 100})`;
                        ctx.fillRect(0, canvas.height - barHeightValue, canvas.width, barHeightValue);
                        
                        // Add text to the black bar
                        ctx.globalAlpha = 1.0;
                        ctx.fillStyle = textColor.value;
                        ctx.font = `${textSize.value}px Arial`;
                        ctx.textAlign = 'center';
                        ctx.textBaseline = 'middle';
                        ctx.fillText(
                            watermarkText,
                            canvas.width / 2,
                            canvas.height - (barHeightValue / 2)
                        );
                    }
                    
                    // Update preview and enable download
                    watermarkedPreview.src = canvas.toDataURL('image/jpeg');
                    downloadBtn.disabled = false;
                };
                
                img.src = originalPreview.src;
            }
        });
    </script>
</body>
</html>
